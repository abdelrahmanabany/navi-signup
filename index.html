<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Navi Landing</title>
    <link rel="stylesheet" href="./style.css" />
  </head>

  <body>
    <main class="page">

      <section class="left">
        <div class="brand">
          <img src="./navi-logo.png" alt="Navi logo" />
        </div>

        <h1 class="headline">
          STUDY SMARTER.<br />
          UNDERSTAND FASTER.
        </h1>

        <div class="points">
          <div class="point">
            <h3>Explain content</h3>
            <p>Break down concepts step by step, in simple language.</p>
          </div>

          <div class="point">
            <h3>Assignment help</h3>
            <p>Get guided support without being given the answer.</p>
          </div>

          <div class="point">
            <h3>Group study</h3>
            <p>Study together, share context, and learn as a group.</p>
          </div>
        </div>
      </section>

      <section class="right">
        <div class="signup-card" id="signupCard">

          <div class="card-content" id="cardContent">
            <h2 class="card-title">SIGN UP</h2>
            <p class="card-subtitle">First 20 get 1 year free</p>

            <form class="signup-form" id="signupForm" autocomplete="off">
              <input class="field" type="text" name="name" placeholder="Name" required />
              <input class="field" type="email" name="email" placeholder="Email" required />
              <!-- Honeypot field - hidden from users, catches bots -->
              <input type="text" name="website" style="position:absolute;left:-9999px;opacity:0;height:0;" tabindex="-1" autocomplete="off" />
              <button class="cta" type="submit">Sign Up</button>
            </form>
          </div>

          <div class="success-message" id="successMessage">
            Thanks for signing up for early access to Navi!
          </div>

        </div>
      </section>

    </main>

    <script>
      const API_URL = "https://navi-signup-api.abdelrahmanabany.workers.dev";

      const form = document.getElementById("signupForm");
      const card = document.getElementById("signupCard");
      const submitBtn = form.querySelector('button[type="submit"]');

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const name = form.name.value.trim();
        const email = form.email.value.trim();
        const website = form.website.value; // Honeypot

        // Disable button while submitting
        submitBtn.disabled = true;
        submitBtn.textContent = "Signing up...";

        try {
          const response = await fetch(API_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, email, website })
          });

          const data = await response.json();

          if (response.ok) {
            card.classList.add("is-success");
          } else {
            alert(data.error || "Something went wrong. Please try again.");
            submitBtn.disabled = false;
            submitBtn.textContent = "Sign Up";
          }
        } catch (error) {
          alert("Network error. Please check your connection and try again.");
          submitBtn.disabled = false;
          submitBtn.textContent = "Sign Up";
        }
      });
    </script>
  </body>
</html>
